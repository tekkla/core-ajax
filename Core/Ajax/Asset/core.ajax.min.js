var CORE=CORE||{};CORE.createNS=function(a){var b=a.split("."),c=CORE;"CORE"===b[0]&&(b=b.slice(1));for(var d=0;d<b.length;d++){var e=b[d];"undefined"==typeof c[e]&&(c[e]={}),c=c[e]}return c},CORE.createNS("CORE.AJAX"),CORE.createNS("CORE.AJAX.COMMAND"),CORE.AJAX.showLog=!1,CORE.AJAX.clickSelector="*[data-ajax]",CORE.AJAX.errortarget="#core-message",CORE.AJAX.handler=function(){var a=!1,b=function(b,c){if(void 0===c)var c="log";a&&console[c](b)},c=function(b){a=b===!0},d=function(a){b(a),jQuery.each(a,function(a,c){"dom"==a&&jQuery.each(c,function(a,c){return jQuery(a).length?void jQuery.each(c,function(c,d){return jQuery.isFunction(jQuery()[d.f])?jQuery(a)[d.f](d.a):void b('Unknown method/function "'+d.f+'"',"error")}):void b('Selector "'+a+'" not found.',"error")}),"act"==a&&jQuery.each(c,function(a,b){switch(b.f){case"call":g(b.a[0],window,b.a[1]);break;default:g(b.f,window,b.a)}})})},e=function(a,b,c,d){if(replaceDuplicates=!0,a.indexOf("#")>0){var e=a.indexOf("#");urlhash=a.substring(a.indexOf("#"),a.length)}else urlhash="",e=a.length;sourceUrl=a.substring(0,e);var f=sourceUrl.split("?"),g="";if(f.length>1)for(var h=f[1].split("&"),i=0;i<h.length;i++){var j=h[i].split("=");replaceDuplicates&&j[0]==b||(""==g?g="?":g+="&",g+=j[0]+"="+(j[1]?j[1]:""))}return""==g&&(g="?"),d?g="?"+b+"="+c+(g.length>1?"&"+g.substring(1):""):(""!==g&&"?"!=g&&(g+="&"),g+=b+"="+(c?c:"")),f[0]+g+urlhash},g=function(a,b){var c=null;c="[object Array]"!==Object.prototype.toString.call(arguments[2])?Array.prototype.slice.call(arguments,2):arguments[2];for(var d=a.split("."),e=d.pop(),f=0;f<d.length;f++)b=b[d[f]];return b[e].apply(b,c)},h=function(a,b,c){var d=void 0!==a?a.responseText:"Ajax Request Error: "+b,e=jQuery(CORE.AJAX.errortarget).length?CORE.AJAX.errortarget:"body";jQuery(e).html(d)},i=function(a){if(void 0===a)return b("Missing ajaxOptions. Aborting ajax.process()"),!1;if(a.hasOwnProperty("success")===!1&&(a.success=d),a.hasOwnProperty("dataType")===!1&&(a.dataType="json"),a.hasOwnProperty("error")===!1&&(a.error=h),a.url===!1){var c="";switch(a.type){case"GET":c='Ajax GET: No URI to query found. Neither as "href", as "data-href" or "data-url". Aborting request.';break;case"POST":c='Ajax POST: No form action for submit found. Neither as "formaction" nor as "data-url", "data-href" from submitting button nor an "action" attribute from the form itself. Aborting request.'}return b(c,"error"),!1}var f=a.url;return a.url=e(f,"ajax",1),"POST"==a.type&&a.data===!1?(b('Ajax POST: No form id to submit found. Neither as "form" nor as "data-form" attribute. Aborting request.',"error"),!1):(b(a,"debug"),jQuery.ajax(a),void("POST"!==a.type&&a.pushState!==!1&&history.pushState(f,"",f)))};return{process:i,showLog:c}},CORE.AJAX.getAjaxOptions=function(a){var b={};jQuery(a).data("ajax")?b=jQuery(a).data("ajax"):void 0!==jQuery(a).data("ajax-options")&&(b=jQuery(a).data("ajax-options"));var c={url:!1,type:"GET",dataType:"json",data:!1,pushState:!0,cache:!1};if(Object.keys(c).forEach(function(a,d){b.hasOwnProperty(a)===!1&&(b[a]=c[a])}),0==b.url||0==b.url.length)if(void 0===jQuery(a).data("form")&&void 0===jQuery(a).attr("form"))switch(!0){case void 0!==jQuery(a).attr("href"):b.url=jQuery(a).attr("href");break;case void 0!==jQuery(a).data("href"):b.url=jQuery(a).data("href");break;case void 0!==jQuery(a).data("url"):b.url=jQuery(a).data("url")}else{b.type="POST";var d=!1;switch(!0){case void 0!==jQuery(a).attr("form"):d=jQuery(a).attr("form");break;case void 0!==jQuery(a).data("form"):d=jQuery(a).data("form")}switch(d!==!1&&(b.data=jQuery("#"+d).serialize()),!0){case void 0!==jQuery(a).attr("formaction"):b.url=jQuery(a).attr("formaction");break;case void 0!==jQuery(a).data("href"):b.url=jQuery(a).data("href");break;case void 0!==jQuery(a).data("url"):b.url=jQuery(a).data("url");break;case d!==!1&&void 0!==jQuery("#"+d).attr("action"):b.url=jQuery("#"+d).attr("action")}}return void 0!==jQuery(a).data("no-state")&&(b.pushState=!1),b},CORE.AJAX.COMMAND.error=function(a,b){jQuery(a).addClass("fade in").append("<p>"+b+"</p>"),jQuery(a).bind("closed.bs.alert",function(){jQuery(this).removeClass().empty().unbind("closed.bs.alert")})},jQuery(document).on("click",CORE.AJAX.clickSelector,function(a){if(a.preventDefault(),void 0!==jQuery(this).attr("data-confirm")&&!confirm(jQuery(this).data("confirm")))return!1;var b=CORE.AJAX.getAjaxOptions(this),c=new CORE.AJAX.handler;c.showLog(CORE.AJAX.showLog),c.process(b)}),jQuery(window).on("load",function(){history.replaceState(document.location.href,document.title,document.location.href)}),jQuery(window).on("popstate",function(a){var b=new CORE.AJAX.handler;b.showLog(CORE.AJAX.showLog),b.process({url:void 0!==a.originalEvent.state?a.originalEvent.state:location.href,pushState:!1})});